diff -ruN a/server/src/analyser.ts b/server/src/analyser.ts
--- a/server/src/analyser.ts
+++ b/server/src/analyser.ts
@@ -61,6 +61,13 @@ export default class Analyzer {
   }

   /**
+   * Remove a document from the cache when it's closed
+   */
+  public deleteDocument(uri: string): void {
+    delete this.uriToAnalyzedDocument[uri]
+  }
+
+  /**
    * Analyze the given document, cache the tree-sitter AST, and iterate over the
    * tree to find declarations.
    */
@@ -821,7 +828,7 @@ export default class Analyzer {
     }

     const uriToAnalyzedDocument = Object.entries(this.uriToAnalyzedDocument)
-    const uris: string[] = []
+    const urisSet = new Set<string>()
     let continueSearching = true

     while (continueSearching) {
@@ -834,10 +841,10 @@ export default class Analyzer {

         for (const sourcedUri of analyzedDocument.sourcedUris.values()) {
           if (
-            (sourcedUri === uri || uris.includes(sourcedUri)) &&
-            !uris.includes(analyzedUri)
+            (sourcedUri === uri || urisSet.has(sourcedUri)) &&
+            !urisSet.has(analyzedUri)
           ) {
-            uris.push(analyzedUri)
+            urisSet.add(analyzedUri)
             continueSearching = true
             break
           }
@@ -845,7 +852,7 @@ export default class Analyzer {
       }
     }

-    return uris
+    return Array.from(urisSet)
   }

   // Private methods
diff -ruN a/server/src/server.ts b/server/src/server.ts
--- a/server/src/server.ts
+++ b/server/src/server.ts
@@ -165,6 +165,8 @@ export default class BashServer {
     this.documents.onDidClose((event) => {
       connection.sendDiagnostics({ uri: event.document.uri, diagnostics: [] })
       delete this.uriToCodeActions[event.document.uri]
+      this.analyzer.deleteDocument(event.document.uri)
+      this.linter?.deleteDocument(event.document.uri)
     })

     // Register all the handlers for the LSP events.
diff -ruN a/server/src/shellcheck/index.ts b/server/src/shellcheck/index.ts
--- a/server/src/shellcheck/index.ts
+++ b/server/src/shellcheck/index.ts
@@ -47,6 +47,10 @@ export class Linter {
     return this._canLint
   }

+  public deleteDocument(uri: string): void {
+    delete this.uriToDebouncedExecuteLint[uri]
+  }
+
   public async lint(
     document: TextDocument,
     sourcePaths: string[],
